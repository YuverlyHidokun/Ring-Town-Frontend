import{a as Le}from"./chunk-YRCT4LZ3.js";import{C as ve,D as Ce,E as _e,G as Ee,d as me,e as pe,g as ge,h as fe,i as he,k as we,l as be,o as ye,p as Pe}from"./chunk-THKJQT2E.js";import{C as q,D as p,E as g,F as ee,M as B,N as te,V as y,Y as k,Z as M,_ as U,bb as le,ea as ne,eb as ce,ga as re,ib as de,ja as ie,jb as ue,la as oe,oa as ae,q as Y,r as v,s as I,ta as se,u as Z,y as N}from"./chunk-MYLL6R6N.js";import"./chunk-CI4HLPRH.js";import"./chunk-E45MTVME.js";import"./chunk-WM6UOLYJ.js";import"./chunk-N5Q5NTLR.js";import"./chunk-JRYKI6H5.js";import"./chunk-GIIU5PV3.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-2YSZFPCQ.js";import"./chunk-57YRIO75.js";import"./chunk-LRFGNCHE.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{g as l}from"./chunk-2R6CW7ES.js";var A=function(o){return o.Unimplemented="UNIMPLEMENTED",o.Unavailable="UNAVAILABLE",o}(A||{}),C=class extends Error{constructor(e,n,i){super(e),this.message=e,this.code=n,this.data=i}},Re=o=>{var e,n;return o?.androidBridge?"android":!((n=(e=o?.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||n===void 0)&&n.bridge?"ios":"web"},Ie=o=>{let e=o.CapacitorCustomPlatform||null,n=o.Capacitor||{},i=n.Plugins=n.Plugins||{},t=()=>e!==null?e.name:Re(o),r=()=>t()!=="web",s=d=>{let u=m.get(d);return!!(u?.platforms.has(t())||a(d))},a=d=>{var u;return(u=n.PluginHeaders)===null||u===void 0?void 0:u.find(j=>j.name===d)},c=d=>o.console.error(d),m=new Map,O=(d,u={})=>{let j=m.get(d);if(j)return console.warn(`Capacitor plugin "${d}" already registered. Cannot register plugins twice.`),j.proxy;let x=t(),S=a(d),P,Ue=()=>l(null,null,function*(){return!P&&x in u?P=typeof u[x]=="function"?P=yield u[x]():P=u[x]:e!==null&&!P&&"web"in u&&(P=typeof u.web=="function"?P=yield u.web():P=u.web),P}),Oe=(f,h)=>{var b,_;if(S){let E=S?.methods.find(w=>h===w.name);if(E)return E.rtype==="promise"?w=>n.nativePromise(d,h.toString(),w):(w,W)=>n.nativeCallback(d,h.toString(),w,W);if(f)return(b=f[h])===null||b===void 0?void 0:b.bind(f)}else{if(f)return(_=f[h])===null||_===void 0?void 0:_.bind(f);throw new C(`"${d}" plugin is not implemented on ${x}`,A.Unimplemented)}},$=f=>{let h,b=(..._)=>{let E=Ue().then(w=>{let W=Oe(w,f);if(W){let D=W(..._);return h=D?.remove,D}else throw new C(`"${d}.${f}()" is not implemented on ${x}`,A.Unimplemented)});return f==="addListener"&&(E.remove=()=>l(null,null,function*(){return h()})),E};return b.toString=()=>`${f.toString()}() { [capacitor code] }`,Object.defineProperty(b,"name",{value:f,writable:!1,configurable:!1}),b},Q=$("addListener"),X=$("removeListener"),Se=(f,h)=>{let b=Q({eventName:f},h),_=()=>l(null,null,function*(){let w=yield b;X({eventName:f,callbackId:w},h)}),E=new Promise(w=>b.then(()=>w({remove:_})));return E.remove=()=>l(null,null,function*(){console.warn("Using addListener() without 'await' is deprecated."),yield _()}),E},K=new Proxy({},{get(f,h){switch(h){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return S?Se:Q;case"removeListener":return X;default:return $(h)}}});return i[d]=K,m.set(d,{name:d,proxy:K,platforms:new Set([...Object.keys(u),...S?[x]:[]])}),K};return n.convertFileSrc||(n.convertFileSrc=d=>d),n.getPlatform=t,n.handleError=c,n.isNativePlatform=r,n.isPluginAvailable=s,n.registerPlugin=O,n.Exception=C,n.DEBUG=!!n.DEBUG,n.isLoggingEnabled=!!n.isLoggingEnabled,n},Ae=o=>o.Capacitor=Ie(o),V=Ae(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),H=V.registerPlugin,R=class{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,n){let i=!1;this.listeners[e]||(this.listeners[e]=[],i=!0),this.listeners[e].push(n);let r=this.windowListeners[e];r&&!r.registered&&this.addWindowListener(r),i&&this.sendRetainedArgumentsForEvent(e);let s=()=>l(this,null,function*(){return this.removeListener(e,n)});return Promise.resolve({remove:s})}removeAllListeners(){return l(this,null,function*(){this.listeners={};for(let e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}})}notifyListeners(e,n,i){let t=this.listeners[e];if(!t){if(i){let r=this.retainedEventArguments[e];r||(r=[]),r.push(n),this.retainedEventArguments[e]=r}return}t.forEach(r=>r(n))}hasListeners(e){var n;return!!(!((n=this.listeners[e])===null||n===void 0)&&n.length)}registerWindowListener(e,n){this.windowListeners[n]={registered:!1,windowEventName:e,pluginEventName:n,handler:i=>{this.notifyListeners(n,i)}}}unimplemented(e="not implemented"){return new V.Exception(e,A.Unimplemented)}unavailable(e="not available"){return new V.Exception(e,A.Unavailable)}removeListener(e,n){return l(this,null,function*(){let i=this.listeners[e];if(!i)return;let t=i.indexOf(n);this.listeners[e].splice(t,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])})}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){let n=this.retainedEventArguments[e];n&&(delete this.retainedEventArguments[e],n.forEach(i=>{this.notifyListeners(e,i)}))}};var xe=o=>encodeURIComponent(o).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),ke=o=>o.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent),z=class extends R{getCookies(){return l(this,null,function*(){let e=document.cookie,n={};return e.split(";").forEach(i=>{if(i.length<=0)return;let[t,r]=i.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");t=ke(t).trim(),r=ke(r).trim(),n[t]=r}),n})}setCookie(e){return l(this,null,function*(){try{let n=xe(e.key),i=xe(e.value),t=`; expires=${(e.expires||"").replace("expires=","")}`,r=(e.path||"/").replace("path=",""),s=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${n}=${i||""}${t}; path=${r}; ${s};`}catch(n){return Promise.reject(n)}})}deleteCookie(e){return l(this,null,function*(){try{document.cookie=`${e.key}=; Max-Age=0`}catch(n){return Promise.reject(n)}})}clearCookies(){return l(this,null,function*(){try{let e=document.cookie.split(";")||[];for(let n of e)document.cookie=n.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}})}clearAllCookies(){return l(this,null,function*(){try{yield this.clearCookies()}catch(e){return Promise.reject(e)}})}},Be=H("CapacitorCookies",{web:()=>new z}),Te=o=>l(null,null,function*(){return new Promise((e,n)=>{let i=new FileReader;i.onload=()=>{let t=i.result;e(t.indexOf(",")>=0?t.split(",")[1]:t)},i.onerror=t=>n(t),i.readAsDataURL(o)})}),Fe=(o={})=>{let e=Object.keys(o);return Object.keys(o).map(t=>t.toLocaleLowerCase()).reduce((t,r,s)=>(t[r]=o[e[s]],t),{})},je=(o,e=!0)=>o?Object.entries(o).reduce((i,t)=>{let[r,s]=t,a,c;return Array.isArray(s)?(c="",s.forEach(m=>{a=e?encodeURIComponent(m):m,c+=`${r}=${a}&`}),c.slice(0,-1)):(a=e?encodeURIComponent(s):s,c=`${r}=${a}`),`${i}&${c}`},"").substr(1):null,We=(o,e={})=>{let n=Object.assign({method:o.method||"GET",headers:o.headers},e),t=Fe(o.headers)["content-type"]||"";if(typeof o.data=="string")n.body=o.data;else if(t.includes("application/x-www-form-urlencoded")){let r=new URLSearchParams;for(let[s,a]of Object.entries(o.data||{}))r.set(s,a);n.body=r.toString()}else if(t.includes("multipart/form-data")||o.data instanceof FormData){let r=new FormData;if(o.data instanceof FormData)o.data.forEach((a,c)=>{r.append(c,a)});else for(let a of Object.keys(o.data))r.append(a,o.data[a]);n.body=r;let s=new Headers(n.headers);s.delete("content-type"),n.headers=s}else(t.includes("application/json")||typeof o.data=="object")&&(n.body=JSON.stringify(o.data));return n},G=class extends R{request(e){return l(this,null,function*(){let n=We(e,e.webFetchExtra),i=je(e.params,e.shouldEncodeUrlParams),t=i?`${e.url}?${i}`:e.url,r=yield fetch(t,n),s=r.headers.get("content-type")||"",{responseType:a="text"}=r.ok?e:{};s.includes("application/json")&&(a="json");let c,m;switch(a){case"arraybuffer":case"blob":m=yield r.blob(),c=yield Te(m);break;case"json":c=yield r.json();break;case"document":case"text":default:c=yield r.text()}let O={};return r.headers.forEach((d,u)=>{O[u]=d}),{data:c,headers:O,status:r.status,url:r.url}})}get(e){return l(this,null,function*(){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))})}post(e){return l(this,null,function*(){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))})}put(e){return l(this,null,function*(){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))})}patch(e){return l(this,null,function*(){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))})}delete(e){return l(this,null,function*(){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))})}},He=H("CapacitorHttp",{web:()=>new G});var L=function(o){return o.Prompt="PROMPT",o.Camera="CAMERA",o.Photos="PHOTOS",o}(L||{}),T=function(o){return o.Rear="REAR",o.Front="FRONT",o}(T||{}),J=function(o){return o.Uri="uri",o.Base64="base64",o.DataUrl="dataUrl",o}(J||{});var F=class extends R{getPhoto(e){return l(this,null,function*(){return new Promise((n,i)=>l(this,null,function*(){if(e.webUseInput||e.source===L.Photos)this.fileInputExperience(e,n,i);else if(e.source===L.Prompt){let t=document.querySelector("pwa-action-sheet");t||(t=document.createElement("pwa-action-sheet"),document.body.appendChild(t)),t.header=e.promptLabelHeader||"Photo",t.cancelable=!1,t.options=[{title:e.promptLabelPhoto||"From Photos"},{title:e.promptLabelPicture||"Take Picture"}],t.addEventListener("onSelection",r=>l(this,null,function*(){r.detail===0?this.fileInputExperience(e,n,i):this.cameraExperience(e,n,i)}))}else this.cameraExperience(e,n,i)}))})}pickImages(e){return l(this,null,function*(){return new Promise((n,i)=>l(this,null,function*(){this.multipleFileInputExperience(n,i)}))})}cameraExperience(e,n,i){return l(this,null,function*(){if(customElements.get("pwa-camera-modal")){let t=document.createElement("pwa-camera-modal");t.facingMode=e.direction===T.Front?"user":"environment",document.body.appendChild(t);try{yield t.componentOnReady(),t.addEventListener("onPhoto",r=>l(this,null,function*(){let s=r.detail;s===null?i(new C("User cancelled photos app")):s instanceof Error?i(s):n(yield this._getCameraPhoto(s,e)),t.dismiss(),document.body.removeChild(t)})),t.present()}catch{this.fileInputExperience(e,n,i)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements."),this.fileInputExperience(e,n,i)})}fileInputExperience(e,n,i){let t=document.querySelector("#_capacitor-camera-input"),r=()=>{var s;(s=t.parentNode)===null||s===void 0||s.removeChild(t)};t||(t=document.createElement("input"),t.id="_capacitor-camera-input",t.type="file",t.hidden=!0,document.body.appendChild(t),t.addEventListener("change",s=>{let a=t.files[0],c="jpeg";if(a.type==="image/png"?c="png":a.type==="image/gif"&&(c="gif"),e.resultType==="dataUrl"||e.resultType==="base64"){let m=new FileReader;m.addEventListener("load",()=>{if(e.resultType==="dataUrl")n({dataUrl:m.result,format:c});else if(e.resultType==="base64"){let O=m.result.split(",")[1];n({base64String:O,format:c})}r()}),m.readAsDataURL(a)}else n({webPath:URL.createObjectURL(a),format:c}),r()}),t.addEventListener("cancel",s=>{i(new C("User cancelled photos app")),r()})),t.accept="image/*",t.capture=!0,e.source===L.Photos||e.source===L.Prompt?t.removeAttribute("capture"):e.direction===T.Front?t.capture="user":e.direction===T.Rear&&(t.capture="environment"),t.click()}multipleFileInputExperience(e,n){let i=document.querySelector("#_capacitor-camera-input-multiple"),t=()=>{var r;(r=i.parentNode)===null||r===void 0||r.removeChild(i)};i||(i=document.createElement("input"),i.id="_capacitor-camera-input-multiple",i.type="file",i.hidden=!0,i.multiple=!0,document.body.appendChild(i),i.addEventListener("change",r=>{let s=[];for(let a=0;a<i.files.length;a++){let c=i.files[a],m="jpeg";c.type==="image/png"?m="png":c.type==="image/gif"&&(m="gif"),s.push({webPath:URL.createObjectURL(c),format:m})}e({photos:s}),t()}),i.addEventListener("cancel",r=>{n(new C("User cancelled photos app")),t()})),i.accept="image/*",i.click()}_getCameraPhoto(e,n){return new Promise((i,t)=>{let r=new FileReader,s=e.type.split("/")[1];n.resultType==="uri"?i({webPath:URL.createObjectURL(e),format:s,saved:!1}):(r.readAsDataURL(e),r.onloadend=()=>{let a=r.result;n.resultType==="dataUrl"?i({dataUrl:a,format:s,saved:!1}):i({base64String:a.split(",")[1],format:s,saved:!1})},r.onerror=a=>{t(a)})})}checkPermissions(){return l(this,null,function*(){if(typeof navigator>"u"||!navigator.permissions)throw this.unavailable("Permissions API not available in this browser");try{return{camera:(yield window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch{throw this.unavailable("Camera permissions are not available in this browser")}})}requestPermissions(){return l(this,null,function*(){throw this.unimplemented("Not implemented on web.")})}pickLimitedLibraryPhotos(){return l(this,null,function*(){throw this.unavailable("Not implemented on web.")})}getLimitedLibraryPhotos(){return l(this,null,function*(){throw this.unavailable("Not implemented on web.")})}},Je=new F;var Me=H("Camera",{web:()=>new F});function De(o,e){if(o&1&&ee(0,"img",11),o&2){let n=te();q("src",n.imagenPreview,Y)}}function qe(o,e){o&1&&(p(0,"div",12),y(1,"Selecciona una foto"),g())}var ft=(()=>{let e=class e{constructor(i,t,r,s){this.http=i,this.router=t,this.toastCtrl=r,this.loadingCtrl=s,this.nombre="",this.apellido="",this.numero="",this.email="",this.password="",this.acepta_terminos=!1,this.fotoPerfil=null,this.imagenPreview=null,this.backendUrl=`${Le}/music/usuarios/registro`}ngOnInit(){}seleccionarFoto(){return l(this,null,function*(){try{let i=yield Me.getPhoto({quality:90,allowEditing:!1,resultType:J.DataUrl,source:L.Photos});if(i?.dataUrl){this.imagenPreview=i.dataUrl;let t=yield(yield fetch(i.dataUrl)).blob();this.fotoPerfil=new File([t],"fotoPerfil.jpg",{type:t.type})}}catch(i){console.error("Error al seleccionar imagen:",i)}})}registrar(){return l(this,null,function*(){if(!this.acepta_terminos){yield(yield this.toastCtrl.create({message:"Debes aceptar los t\xE9rminos y condiciones.",duration:3e3,color:"danger"})).present();return}let i=yield this.loadingCtrl.create({message:"Registrando usuario..."});yield i.present();let t=new FormData;t.append("nombre",this.nombre),t.append("apellido",this.apellido),t.append("numero",this.numero),t.append("email",this.email),t.append("password",this.password),t.append("acepta_terminos",String(this.acepta_terminos)),this.fotoPerfil&&t.append("imagen",this.fotoPerfil),this.http.post(this.backendUrl,t).subscribe({next:r=>l(this,null,function*(){yield i.dismiss(),yield(yield this.toastCtrl.create({message:r.msg||"Registro exitoso",duration:3e3,color:"success"})).present(),this.router.navigate(["/login"])}),error:r=>l(this,null,function*(){yield i.dismiss(),yield(yield this.toastCtrl.create({message:r.error?.msg||"Error al registrar",duration:3e3,color:"danger"})).present()})})})}irATerminos(){this.router.navigate(["/terminos"])}};e.\u0275fac=function(t){return new(t||e)(I(ie),I(ae),I(Ce),I(ve))},e.\u0275cmp=Z({type:e,selectors:[["app-register"]],decls:35,vars:8,consts:[[3,"click"],["alt","Foto de perfil","class","imagen-preview",3,"src",4,"ngIf"],["class","placeholder-avatar",4,"ngIf"],["position","floating"],["required","",3,"ngModelChange","ngModel"],["type","tel",3,"ngModelChange","ngModel"],["type","email","required","",3,"ngModelChange","ngModel"],["type","password","required","",3,"ngModelChange","ngModel"],["lines","none"],["slot","start",3,"ngModelChange","ngModel"],["expand","block",3,"click"],["alt","Foto de perfil",1,"imagen-preview",3,"src"],[1,"placeholder-avatar"]],template:function(t,r){t&1&&(p(0,"ion-content")(1,"ion-card")(2,"ion-card-header")(3,"ion-card-title"),y(4,"Crear Cuenta"),g()(),p(5,"ion-card-content")(6,"ion-avatar",0),B("click",function(){return r.seleccionarFoto()}),N(7,De,1,1,"img",1)(8,qe,2,0,"div",2),g(),p(9,"ion-item")(10,"ion-label",3),y(11,"Nombre"),g(),p(12,"ion-input",4),U("ngModelChange",function(a){return M(r.nombre,a)||(r.nombre=a),a}),g()(),p(13,"ion-item")(14,"ion-label",3),y(15,"Apellido"),g(),p(16,"ion-input",4),U("ngModelChange",function(a){return M(r.apellido,a)||(r.apellido=a),a}),g()(),p(17,"ion-item")(18,"ion-label",3),y(19,"N\xFAmero"),g(),p(20,"ion-input",5),U("ngModelChange",function(a){return M(r.numero,a)||(r.numero=a),a}),g()(),p(21,"ion-item")(22,"ion-label",3),y(23,"Correo electr\xF3nico"),g(),p(24,"ion-input",6),U("ngModelChange",function(a){return M(r.email,a)||(r.email=a),a}),g()(),p(25,"ion-item")(26,"ion-label",3),y(27,"Contrase\xF1a"),g(),p(28,"ion-input",7),U("ngModelChange",function(a){return M(r.password,a)||(r.password=a),a}),g()(),p(29,"ion-item",8)(30,"ion-checkbox",9),U("ngModelChange",function(a){return M(r.acepta_terminos,a)||(r.acepta_terminos=a),a}),g(),p(31,"ion-label",0),B("click",function(){return r.irATerminos()}),y(32,"Acepto t\xE9rminos y condiciones"),g()(),p(33,"ion-button",10),B("click",function(){return r.registrar()}),y(34,"Registrarse"),g()()()()),t&2&&(v(7),q("ngIf",r.imagenPreview),v(),q("ngIf",!r.imagenPreview),v(4),k("ngModel",r.nombre),v(4),k("ngModel",r.apellido),v(4),k("ngModel",r.numero),v(4),k("ngModel",r.email),v(4),k("ngModel",r.password),v(2),k("ngModel",r.acepta_terminos))},dependencies:[re,ne,ue,le,de,ce,oe,se,be,ye,Pe,Ee,_e,pe,me,ge,fe,he,we],styles:["ion-content[_ngcontent-%COMP%]{--background: #121212;color:#fff;display:flex;justify-content:center;align-items:center;padding:16px;min-height:100vh}ion-card[_ngcontent-%COMP%]{background-color:#181818;border-radius:16px;padding:24px;width:100%;max-width:420px;box-shadow:0 0 15px #0009}ion-card-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:20px}ion-card-title[_ngcontent-%COMP%]{color:#1db954;font-size:1.8rem;font-weight:700}ion-item[_ngcontent-%COMP%]{--background: #222;--color: #fff;border-radius:10px;border:1px solid #333;margin-top:14px}ion-label[_ngcontent-%COMP%]{color:#b3b3b3}ion-input[_ngcontent-%COMP%]{color:#fff}ion-checkbox[_ngcontent-%COMP%]{--background: #1DB954;--checkmark-color: #121212}ion-button[_ngcontent-%COMP%]{margin-top:20px;--background: #1DB954;--color: #121212;font-weight:600;border-radius:10px}ion-avatar[_ngcontent-%COMP%]{margin:0 auto 20px;width:120px;height:120px;border-radius:50%;overflow:hidden;box-shadow:0 0 10px #1db954;cursor:pointer;transition:transform .3s ease}ion-avatar[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.imagen-preview[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;border-radius:50%}"]});let o=e;return o})();export{ft as RegisterPage};
