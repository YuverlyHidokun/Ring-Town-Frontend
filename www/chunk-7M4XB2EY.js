import{a as N}from"./chunk-YRCT4LZ3.js";import{B as H,C as $,D as z,F as L,e as U,l as V,o as A,p as j,q as F}from"./chunk-THKJQT2E.js";import{C as x,D as l,E as c,F as y,L as C,M as h,N as d,U as I,V as g,W as P,aa as M,da as k,ea as O,ga as v,j as u,ja as T,k as _,la as E,oa as S,r as p,s as m,u as w,y as b}from"./chunk-MYLL6R6N.js";import"./chunk-CI4HLPRH.js";import"./chunk-E45MTVME.js";import"./chunk-WM6UOLYJ.js";import"./chunk-N5Q5NTLR.js";import"./chunk-JRYKI6H5.js";import"./chunk-GIIU5PV3.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-2YSZFPCQ.js";import"./chunk-57YRIO75.js";import"./chunk-LRFGNCHE.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{g as r}from"./chunk-2R6CW7ES.js";function R(n,a){if(n&1){let s=C();l(0,"ion-item",6),h("click",function(){let e=u(s).$implicit,i=d(2);return _(i.verPlaylist(e))}),l(1,"ion-label")(2,"h2"),g(3),c(),l(4,"p"),g(5),c()(),l(6,"ion-button",7),h("click",function(e){let i=u(s).$implicit;return d(2).eliminarPlaylist(i._id),_(e.stopPropagation())}),y(7,"ion-icon",8),c()()}if(n&2){let s=a.$implicit;p(3),P(s.nombre),p(2),P(s.descripcion)}}function q(n,a){if(n&1&&(l(0,"ion-list"),b(1,R,8,2,"ion-item",5),c()),n&2){let s=d();p(),x("ngForOf",s.playlists)}}function B(n,a){if(n&1){let s=C();l(0,"div",9),y(1,"ion-icon",10),l(2,"p"),g(3,"No tienes playlists a\xFAn."),c(),l(4,"ion-button",11),h("click",function(){u(s);let e=d();return _(e.abrirModalCrearPlaylist())}),g(5," Crear una playlist "),c()()}}var ot=(()=>{let a=class a{constructor(t,e,i,o,f){this.http=t,this.toastCtrl=e,this.alertCtrl=i,this.loadingCtrl=o,this.router=f,this.playlists=[],this.backendUrl=`${N}/music/playlists`}ionViewWillEnter(){this.cargarPlaylists()}getAuthHeaders(){return{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}}cargarPlaylists(){this.http.get(this.backendUrl,this.getAuthHeaders()).subscribe({next:t=>{this.playlists=t.playlists||t},error:()=>r(this,null,function*(){yield(yield this.toastCtrl.create({message:"Error al cargar playlists",duration:3e3,color:"danger"})).present()})})}abrirModalCrearPlaylist(){return r(this,null,function*(){yield(yield this.alertCtrl.create({header:"Crear nueva playlist",inputs:[{name:"nombre",type:"text",placeholder:"Nombre de la playlist"},{name:"descripcion",type:"text",placeholder:"Descripci\xF3n"}],buttons:[{text:"Cancelar",role:"cancel"},{text:"Crear",handler:e=>!e.nombre||e.nombre.trim().length===0?!1:(this.crearPlaylist(e.nombre,e.descripcion),!0)}]})).present()})}crearPlaylist(t,e){return r(this,null,function*(){let i=yield this.loadingCtrl.create({message:"Creando playlist..."});yield i.present(),this.http.post(this.backendUrl,{nombre:t,descripcion:e},this.getAuthHeaders()).subscribe({next:o=>r(this,null,function*(){yield i.dismiss(),this.cargarPlaylists(),yield(yield this.toastCtrl.create({message:o.msg||"Playlist creada",duration:3e3,color:"success"})).present()}),error:o=>r(this,null,function*(){yield i.dismiss(),yield(yield this.toastCtrl.create({message:o.error?.msg||"Error al crear playlist",duration:3e3,color:"danger"})).present()})})})}eliminarPlaylist(t){return r(this,null,function*(){yield(yield this.alertCtrl.create({header:"Confirmar eliminaci\xF3n",message:"\xBFSeguro que quieres eliminar esta playlist?",buttons:[{text:"Cancelar",role:"cancel"},{text:"Eliminar",handler:()=>r(this,null,function*(){let i=yield this.loadingCtrl.create({message:"Eliminando..."});yield i.present(),this.http.delete(`${this.backendUrl}/${t}`,this.getAuthHeaders()).subscribe({next:()=>r(this,null,function*(){yield i.dismiss(),this.cargarPlaylists(),yield(yield this.toastCtrl.create({message:"Playlist eliminada",duration:3e3,color:"success"})).present()}),error:()=>r(this,null,function*(){yield i.dismiss(),yield(yield this.toastCtrl.create({message:"Error al eliminar playlist",duration:3e3,color:"danger"})).present()})})})}]})).present()})}verPlaylist(t){this.router.navigate(["/playlist",t._id])}reproducirCancion(t){this.router.navigate(["/reproductor"],{queryParams:{audioUrl:t.audioUrl,titulo:t.titulo,artista:t.artista,portadaUrl:t.portadaUrl,cancionId:t._id}})}};a.\u0275fac=function(e){return new(e||a)(m(T),m(z),m(H),m($),m(S))},a.\u0275cmp=w({type:a,selectors:[["app-tab2"]],decls:6,vars:2,consts:[["sinPlaylists",""],["fullscreen","",1,"ion-padding","page-bg"],[1,"logo-container"],["src","assets/logo.png","alt","Ring Town",1,"logo"],[4,"ngIf","ngIfElse"],["class","playlist-item","lines","none","detail","",3,"click",4,"ngFor","ngForOf"],["lines","none","detail","",1,"playlist-item",3,"click"],["fill","clear","color","danger","slot","end",3,"click"],["slot","icon-only","name","trash-outline"],[1,"no-playlists"],["name","musical-notes-outline","size","large","color","medium"],["color","success",3,"click"]],template:function(e,i){if(e&1&&(l(0,"ion-content",1)(1,"div",2),y(2,"img",3),c(),b(3,q,2,1,"ion-list",4)(4,B,6,0,"ng-template",null,0,M),c()),e&2){let o=I(5);p(3),x("ngIf",i.playlists.length>0)("ngIfElse",o)}},dependencies:[V,F,A,j,U,L,E,v,k,O],styles:['@charset "UTF-8";ion-content[_ngcontent-%COMP%]{--background: #121212;color:#fff}ion-toolbar[_ngcontent-%COMP%]{--background: #181818;--color: #fff;border:none;box-shadow:none}.logo-container[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:20px 0}.logo[_ngcontent-%COMP%]{height:45px;object-fit:contain}ion-button.crear-btn[_ngcontent-%COMP%]{--background: #1db954;--color: #000;--border-radius: 20px;font-weight:600;margin:16px;padding:12px 20px;text-transform:none}ion-list[_ngcontent-%COMP%]{padding:0 16px}ion-item.playlist-item[_ngcontent-%COMP%]{--background: #1e1e1e;--padding-start: 12px;--inner-padding-end: 0;border-radius:12px;margin-bottom:10px;border:1px solid #2a2a2a}ion-item.playlist-item[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#fff;font-size:1rem;margin-bottom:4px}ion-item.playlist-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#aaa;font-size:.85rem}ion-item.playlist-item[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--color: #1db954;font-size:.8rem;margin-left:auto;margin-right:6px}.no-playlists[_ngcontent-%COMP%]{text-align:center;margin-top:25%;color:#ccc}.no-playlists[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:52px;color:#666;margin-bottom:12px}.no-playlists[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin-top:14px;--background: #1db954;--color: #000;--border-radius: 20px;padding:10px 20px;font-weight:600}']});let n=a;return n})();export{ot as Tab2Page};
